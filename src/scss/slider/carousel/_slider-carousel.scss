// *** slider-carousel *** //
@mixin slider-carousel(
  $items: 5,
  $perpage: 1,
  $gutter: 10px,
  $slide-by-page: false,
  $hide-half: false,
  $hide: 'autoplay', // none | controls | dots | autoplay
  $default: true
){
  $half: 0;
  $prefix: get-slider-selector(&);
  $id: "#" + $prefix;
  @if $hide-half == true and $perpage > 1 { 
    $half: (1 / ($perpage * 2)); 
  }
  @at-root (without: media) { 
    @extend %slide-base; 
  }

  // basic
  .slider-container {
    @if $perpage != 1 { li { width: percentage(1/$perpage) } }
    @if $gutter != 0 and $gutter != 0px and $gutter != null and $gutter != false {
      @if $hide-half == false { margin: 0 (- $gutter); }
      .item { margin: 0 $gutter; }
    }
  }

  // setting inner
  @for $i from 1 through $items {
    @at-root {
      #{$id}-#{$i}:checked ~ {
        .slider-container .inner { 
          @if ($i / $perpage) >= floor($items / $perpage) and 
              ($i / $perpage) < ceil($items / $perpage) {
            left: - percentage(($items / $perpage) - 1 - $half);
          }
          @else {
            left: - percentage(($i - 1) / $perpage + $half); 
          }
        }
      }
    }
  }

  // animation
  @if str-index($hide, 'autoplay') == null {
    $left-val: 0;
    $frames: 1;
    @if $slide-by-page == true { $frames: ceil($items/$perpage); }
    @else { $frames: $items + 1 - $perpage; }
    $unit: (100/($peritem * $frames));

    @include keyframes(#{$prefix}-inner) {
      @for $i from 1 through $frames {
        @if $slide-by-page == true {
          @if (- ($i - 1) * 100%) < percentage(1 - $items / $perpage) {
            $left-val: percentage(1 - $items / $perpage);
          }
          @else { $left-val: (- ($i - 1) * 100%);}

          #{percentage((($i - 1) * $peritem) * $unit / 100)} { left: $left-val; }
          #{percentage(($i * $peritem - $play) * $unit / 100)} { left: $left-val; }
        }
        @else { 
          $left-val: percentage(- ($i - 1) / $perpage);

          #{percentage((($i - 1) * $peritem) * $unit / 100)} { left: $left-val; }
          #{percentage(($i * $peritem - $play) * $unit / 100)} { left: $left-val; }
        }
      }
      100% { left: 0; }
    }
    @at-root {
      #{$id}-autoplay:checked ~ {
        .slider-container .inner { @include animation(#{$prefix}-inner $peritem * $frames ease infinite); }
      }
    }
  }

  // setting controls
  @if str-index($hide, 'controls') == null {
    @at-root {
      @for $i from 1 through $items {
        #{$id}-#{$i}:checked ~ {
          @if $slide-by-page == true {
            @if $i == 1 {
              .controls label:nth-child(#{$items - $perpage + 1}) .prev,
              .controls label:nth-child(#{$i + $perpage}) .next { display: block; }
            }
            @if $i > 1 and $i <= $perpage {
              .controls label:nth-child(1) .prev, 
              .controls label:nth-child(#{$i + $perpage}) .next { display: block; }
            }
            @if $i > ($items - 2 * $perpage + 1) and $i < ($items - $perpage + 1) {
              .controls label:nth-child(#{$i - $perpage}) .prev, 
              .controls label:nth-child(#{$items - $perpage + 1}) .next { display: block; }
            }
            @if $i >= ($items - $perpage + 1) {
              .controls label:nth-child(#{$i - $perpage}) .prev, 
              .controls label:nth-child(1) .next { display: block; }
            }
            @else {
              .controls label:nth-child(#{$i - $perpage}) .prev, 
              .controls label:nth-child(#{$i + $perpage}) .next { display: block; }
            }
          }
          @else {
            @if $i == 1 {
              .controls label:nth-child(#{$items}) .prev, 
              .controls label:nth-child(#{$i + 1}) .next { display: block; }
            }
            @else if $i == $items {
              .controls label:nth-child(#{$i - 1}) .prev, 
              .controls label:nth-child(1) .next { display: block; }
            }
            @else {
              .controls label:nth-child(#{$i - 1}) .prev, 
              .controls label:nth-child(#{$i + 1}) .next { display: block; }
            }
          }
        }
      }
    }
  }

  @at-root (without: media) { 
    // setting controls
    @if str-index($hide, 'controls') == null {
      @if $default == true { @extend %default-controls; }
    }

    // setting dots
    @if str-index($hide, 'dots') == null {
      @if $default == true { @extend %default-dots; }
      @for $i from 1 through $items {
        @at-root {
          #{$id}-#{$i}:checked ~ {
            .dots label:nth-child(#{$i}) .active { @extend %show; }
            .dots label:nth-child(#{$i}) .normal { @extend %hide; }
          }
        }
      }
      // redefine dots on autoplay
      @at-root {
        #{$id}-autoplay:checked ~ .dots { display: none; }
      }
    }

    // setting autoplay
    @if str-index($hide, 'autoplay') == null {
      @if $default {
        @extend %default-autoplay;
        @at-root {
          #{$id}-autoplay:checked ~ .autoplay label:before { content: '1'; }
        }
      }
    }

  } // @at-root end

  // hide controls, dots or autoplay
  @each $item in controls, dots, autoplay {
    @if str-index($hide, $item) != null {
      & .#{$item} { display: none !important; }
    }
  }

}