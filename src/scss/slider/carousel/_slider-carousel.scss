// *** slide-carousel *** //
$time: 3s;

@mixin slide-carousel(
  $items: 5,
  $perpage: 1,
  $gutter: 10px,
  $slide-by-page: true,
  $cut: false,
  $hide: none, // none | controls | dots
  $default: true
){
  $id: "#" + get-slider-selector(&);
  $adjustment: 0;
  @if $cut == true { $adjustment: (1 / ($perpage * 2)); }
  @at-root (without: media) { @extend %slide-base; }

  // basic
  .slide-container {

    // setting item width
    @if $perpage != 1 {
      li { width: percentage(1/$perpage); }
    }

    // setting gutter
    @if $gutter != 0 and $gutter != 0px and $gutter != null and $gutter != false {
      @if $cut == false { margin: 0 (- $gutter); }
      .item { margin: 0 $gutter; }
    }
  }

  // setting inner
  @for $i from 1 through $items {
    @at-root #{$id}-#{$i}:checked ~ {
      .slide-container .inner { 
        @if ($i / $perpage) >= floor($items / $perpage) and 
            ($i / $perpage) < ceil($items / $perpage) {
          left: - percentage(($items / $perpage) - 1 - $adjustment);
        }
        @else {
          left: - percentage(($i - 1) / $perpage + $adjustment); 
        }
      }
    }
  }

  // setting controls
  @if $hide != controls {
    @if $slide-by-page == true {
      @for $i from 1 through $items {
        @at-root (without: media) { 
          #{$id}-#{$i}:checked ~ {
            @if $i == 1 {
              .controls label:nth-child(#{$items - $perpage + 1}) .prev { @extend %show; }
              .controls label:nth-child(#{$i + $perpage}) .next { @extend %show; }
            }
            @if $i > 1 and $i <= $perpage {
              .controls label:nth-child(1) .prev { @extend %show; }
              .controls label:nth-child(#{$i + $perpage}) .next { @extend %show; }
            }
            @if $i > ($items - 2 * $perpage + 1) and $i < ($items - $perpage + 1) {
              .controls label:nth-child(#{$i - $perpage}) .prev { @extend %show; }
              .controls label:nth-child(#{$items - $perpage + 1}) .next { @extend %show; }
            }
            @if $i >= ($items - $perpage + 1) {
              .controls label:nth-child(#{$i - $perpage}) .prev { @extend %show; }
              .controls label:nth-child(1) .next { @extend %show; }
            }
            @else {
              .controls label:nth-child(#{$i - $perpage}) .prev { @extend %show; }
              .controls label:nth-child(#{$i + $perpage}) .next { @extend %show; }
            }
          }
        }
      }
    }
  }

  // animation
  @include keyframes(slide-inner) {
    0% { left: 0; }
    @for $i from 1 to $items {
      @if $i <= ($items - $perpage) {
        #{percentage($i / $items)} { left: percentage(- $i / $perpage); }
      }
    }
    100% { left: 0; }
  }
  #slide-autoplay:checked ~ {
    .slide-container .inner { @include animation(slide-inner #{$items / $perpage * $time} ease infinite); }
  }

  // hide controls or dots
  @if $hide != 'none' {
    @at-root (without: media) {
      & .#{$hide} { display: none !important; }
    }
  }

  // show controls
  @if $hide != controls {
    @if $default == true { @at-root (without: media) { @extend %default-controls; } }
  }

  // setting and show dots
  @if $hide != dots {
    @if $default == true { @at-root (without: media) { @extend %default-dots; } }
    @for $i from 1 through $items {
      @at-root (without: media) { 
        #{$id}-#{$i}:checked ~ {
          .dots label:nth-child(#{$i}) .active { @extend %show; }
          .dots label:nth-child(#{$i}) .normal { @extend %hide; }
        }
      }
    }
  }

  // show autoplay
  @if $default {
    @at-root (without: media) { 
      @extend %default-autoplay;
      #{$id}-autoplay:checked ~ .autoplay { label:before { content: '1'; } }
    }
  }
}


ul { margin: 0; padding: 0; }
.container { max-width: 1024px; margin: 20px auto; }
.slide { @include slide-carousel(); margin-bottom: 40px; }

// move controls inside 
@include bp-ma(1178){
  .controls { padding-left: 15%; padding-right: 15%; }
}